(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[427],{1088:function(e,s,t){Promise.resolve().then(t.bind(t,1152))},1152:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return _}});var a=t(7437),r=t(2265),l=t(9376),n=t(7648),i=t(970),c=t(9178),d=t(4226),o=t(5337),x=t(8736),u=t(4159),m=t(8997),h=t(2208),p=t(2660),j=t(3247),f=t(9374),g=t(2369),v=t(1047),N=t(2735),b=t(4284),y=t(1344),w=t(8349),Z=t(2690);function _(){let e=(0,l.useRouter)(),[s,t]=(0,r.useState)(null),[_,k]=(0,r.useState)([]),[S,C]=(0,r.useState)(!0),[L,E]=(0,r.useState)(null),[P,R]=(0,r.useState)(""),[q,z]=(0,r.useState)("all");async function D(){try{let s=(0,i.e)(),{data:{user:a},error:r}=await s.auth.getUser();if(r||!a){e.push("/start-case");return}let{data:l,error:n}=await s.from("profiles").select("*").eq("id",a.id).single();if(n){e.push("/start-case");return}t(l);let{data:c,error:d}=await s.from("medical_records").select("\n          *,\n          patient:patients(\n            profile:profiles(full_name, email)\n          )\n        ").eq("doctor_id",a.id).order("created_at",{ascending:!1});if(d)console.error("Error fetching patient records:",d);else{let e=(null==c?void 0:c.map(e=>{var s,t,a,r;return{id:e.id,patient_name:(null===(t=e.patient)||void 0===t?void 0:null===(s=t.profile)||void 0===s?void 0:s.full_name)||"Unknown Patient",patient_email:(null===(r=e.patient)||void 0===r?void 0:null===(a=r.profile)||void 0===a?void 0:a.email)||"Unknown Email",record_type:e.type,title:e.title,date:e.date,notes:e.notes,status:e.status}}))||[];k(e)}}catch(e){console.error("Error fetching doctor data:",e),E("Failed to load patient records")}finally{C(!1)}}(0,r.useEffect)(()=>{D()},[]);let M=e=>{switch(e){case"Consultation":return(0,a.jsx)(o.Z,{className:"w-5 h-5"});case"Lab Results":default:return(0,a.jsx)(x.Z,{className:"w-5 h-5"});case"Prescription":return(0,a.jsx)(u.Z,{className:"w-5 h-5"});case"Vital Signs":return(0,a.jsx)(m.Z,{className:"w-5 h-5"});case"Imaging":return(0,a.jsx)(h.Z,{className:"w-5 h-5"})}},V=e=>{switch(e){case"completed":return"text-green-600 bg-green-50";case"pending":return"text-yellow-600 bg-yellow-50";case"cancelled":return"text-red-600 bg-red-50";default:return"text-gray-600 bg-gray-50"}},I=_.filter(e=>{let s=e.patient_name.toLowerCase().includes(P.toLowerCase())||e.title.toLowerCase().includes(P.toLowerCase()),t="all"===q||e.record_type===q;return s&&t});return S?(0,a.jsx)(Z.Z,{requiredRole:"doctor",children:(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,a.jsx)(b.Z,{}),(0,a.jsx)(y.Z,{}),(0,a.jsx)("div",{className:"pt-32 pb-16",children:(0,a.jsx)("div",{className:"max-w-6xl mx-auto px-6",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-lg text-gray-600",children:"Loading patient records..."})]})})})]})}):(0,a.jsx)(Z.Z,{requiredRole:"doctor",children:(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,a.jsx)(b.Z,{}),(0,a.jsx)(y.Z,{}),(0,a.jsx)("div",{className:"pt-32 pb-16",children:(0,a.jsxs)("div",{className:"max-w-6xl mx-auto px-6",children:[L&&(0,a.jsx)("div",{className:"mb-6 p-4 bg-red-50 border border-red-400 text-red-700 rounded",children:(0,a.jsxs)("p",{children:[(0,a.jsx)("strong",{children:"Error:"})," ",L]})}),(0,a.jsx)("div",{className:"mb-8",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)(n.default,{href:"/doctor/dashboard",children:(0,a.jsx)(d.Z,{variant:"ghost",icon:p.Z,children:"Back to Dashboard"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-slate-900",children:"Patient Records"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Manage and view patient medical records"})]})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsx)("div",{className:"text-sm text-gray-500",children:"Doctor"}),(0,a.jsxs)("div",{className:"font-semibold text-slate-900",children:["Dr. ",null==s?void 0:s.full_name]}),(0,a.jsx)("div",{className:"text-xs text-gray-500",children:null==s?void 0:s.specialty})]})]})}),(0,a.jsxs)("div",{className:"mb-6 flex flex-col sm:flex-row gap-4",children:[(0,a.jsx)("div",{className:"flex-1",children:(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(j.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),(0,a.jsx)("input",{type:"text",placeholder:"Search patients or records...",value:P,onChange:e=>R(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})}),(0,a.jsx)("div",{className:"flex gap-2",children:(0,a.jsxs)("select",{value:q,onChange:e=>z(e.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,a.jsx)("option",{value:"all",children:"All Types"}),(0,a.jsx)("option",{value:"Consultation",children:"Consultation"}),(0,a.jsx)("option",{value:"Lab Results",children:"Lab Results"}),(0,a.jsx)("option",{value:"Prescription",children:"Prescription"}),(0,a.jsx)("option",{value:"Vital Signs",children:"Vital Signs"}),(0,a.jsx)("option",{value:"Imaging",children:"Imaging"})]})})]}),(0,a.jsxs)(c.Zb,{children:[(0,a.jsx)(c.Ol,{children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("h2",{className:"text-xl font-bold text-slate-900",children:"Patient Medical Records"}),(0,a.jsxs)("div",{className:"text-sm text-gray-500",children:[I.length," record",1!==I.length?"s":""]})]})}),(0,a.jsx)(c.eW,{children:0===I.length?(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)(x.Z,{className:"w-12 h-12 text-gray-300 mx-auto mb-4"}),(0,a.jsx)("h3",{className:"font-semibold text-gray-900 mb-2",children:"No Patient Records"}),(0,a.jsx)("p",{className:"text-gray-600 text-sm mb-4",children:"Patient records will appear here once you start consultations"}),(0,a.jsx)(n.default,{href:"/teleconsultation",children:(0,a.jsx)(d.Z,{size:"sm",icon:f.Z,children:"Start Consultation"})})]}):(0,a.jsx)("div",{className:"space-y-4",children:I.map(e=>(0,a.jsx)("div",{className:"border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow",children:(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsxs)("div",{className:"flex items-start gap-3",children:[(0,a.jsx)("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:M(e.record_type)}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-semibold text-slate-900",children:e.title}),(0,a.jsx)("p",{className:"text-sm text-gray-600 mb-2",children:e.notes}),(0,a.jsxs)("div",{className:"flex items-center gap-4 text-sm text-gray-500",children:[(0,a.jsxs)("span",{className:"flex items-center gap-1",children:[(0,a.jsx)(g.Z,{className:"w-4 h-4"}),e.patient_name]}),(0,a.jsxs)("span",{className:"flex items-center gap-1",children:[(0,a.jsx)(v.Z,{className:"w-4 h-4"}),new Date(e.date).toLocaleDateString()]}),(0,a.jsx)("span",{className:"text-blue-600 font-medium",children:e.record_type})]})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium ".concat(V(e.status)),children:e.status}),(0,a.jsx)(d.Z,{variant:"ghost",size:"sm",icon:h.Z,children:"View"}),(0,a.jsx)(d.Z,{variant:"ghost",size:"sm",icon:N.Z,children:"Download"})]})]})},e.id))})})]})]})}),(0,a.jsx)(w.default,{})]})})}},2660:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});let a=(0,t(9763).Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},2208:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});let a=(0,t(9763).Z)("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},3247:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});let a=(0,t(9763).Z)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]])}},function(e){e.O(0,[972,862,137,188,349,422,741,971,117,744],function(){return e(e.s=1088)}),_N_E=e.O()}]);