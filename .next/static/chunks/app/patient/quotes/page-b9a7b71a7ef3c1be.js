(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[869],{9463:function(e,t,s){Promise.resolve().then(s.bind(s,4032))},4032:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return N}});var a=s(7437),r=s(2265),n=s(7648),l=s(970),i=s(9178),c=s(4226),d=s(1723),o=s(5302),x=s(2252),m=s(2660),u=s(3417),h=s(2369),f=s(5252),j=s(1047),p=s(2208),b=s(4284),g=s(1344),y=s(8349);function N(){var e,t;let[s,N]=(0,r.useState)([]),[v,w]=(0,r.useState)(!0),[Z,k]=(0,r.useState)(null),[_,S]=(0,r.useState)(null),[q,C]=(0,r.useState)(null),[I,z]=(0,r.useState)(!1),[D,A]=(0,r.useState)(null);async function M(){try{let e=(0,l.e)(),{data:{user:t}}=await e.auth.getUser();if(!t){S("Please sign in to view quotes");return}let{data:s}=await e.from("patients").select("*").eq("profile_id",t.id).single();if(!s){S("Patient record not found");return}let{data:a,error:r}=await e.from("quotes").select("\n          *,\n          case:cases(id, patient_id, treatment_id, status, patient_notes, treatment:treatments(id, name, description)),\n          doctor:profiles(id, full_name, email)\n        ").eq("case.patient_id",s.id).order("created_at",{ascending:!1});if(r)throw r;N(a||[])}catch(e){S("Failed to load quotes"),console.error("Error fetching quotes:",e)}finally{w(!1)}}async function R(e,t){k(e),S(null);try{let s=(0,l.e)(),{data:a}=await s.from("quotes").select("*").eq("id",e).single();if(!a)throw Error("Quote not found");let{error:r}=await s.from("quotes").update({status:"accepted",updated_at:new Date().toISOString()}).eq("id",e);if(r)throw r;let{error:n}=await s.from("cases").update({status:"accepted",updated_at:new Date().toISOString()}).eq("id",t);if(n)throw n;let i=a.total||0,c=Math.round(.15*i),d=i-c,{error:o}=await s.from("finance_notes").insert({case_id:t,quote_id:e,x_amount:i,a_fee:c,y_transfer:d,z_profit:c,currency:a.currency||"INR",status:"pending",payment_method:"payment_link_pending",created_at:new Date().toISOString()});if(o)throw o;A(a),z(!0),await M()}catch(e){S(e.message||"Failed to accept quote")}finally{k(null)}}(0,r.useEffect)(()=>{M()},[]);let O=e=>{switch(e){case"draft":default:return"bg-gray-100 text-gray-800";case"sent":return"bg-blue-100 text-blue-800";case"accepted":return"bg-green-100 text-green-800"}},Q=e=>{switch(e){case"sent":return(0,a.jsx)(d.Z,{className:"w-4 h-4"});case"accepted":return(0,a.jsx)(o.Z,{className:"w-4 h-4"});default:return(0,a.jsx)(x.Z,{className:"w-4 h-4"})}};return v?(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,a.jsx)(b.Z,{}),(0,a.jsx)(g.Z,{}),(0,a.jsx)("div",{className:"pt-32 pb-16",children:(0,a.jsx)("div",{className:"max-w-4xl mx-auto px-6",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-lg text-gray-600",children:"Loading quotes..."})]})})})]}):(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,a.jsx)(b.Z,{}),(0,a.jsx)(g.Z,{}),(0,a.jsx)("div",{className:"pt-32 pb-16",children:(0,a.jsxs)("div",{className:"max-w-4xl mx-auto px-6",children:[(0,a.jsx)("div",{className:"mb-8",children:(0,a.jsx)(n.default,{href:"/patient/dashboard",children:(0,a.jsx)(c.Z,{variant:"ghost",icon:m.Z,children:"Back to Dashboard"})})}),_&&(0,a.jsxs)("div",{className:"mb-6 p-4 bg-red-50 border border-red-200 rounded-lg flex items-center gap-3",children:[(0,a.jsx)(x.Z,{className:"w-5 h-5 text-red-600 flex-shrink-0"}),(0,a.jsx)("p",{className:"text-red-800 text-sm",children:_})]}),q&&(0,a.jsxs)("div",{className:"mb-6 p-4 bg-green-50 border border-green-200 rounded-lg flex items-center gap-3",children:[(0,a.jsx)(o.Z,{className:"w-5 h-5 text-green-600 flex-shrink-0"}),(0,a.jsx)("p",{className:"text-green-800 text-sm",children:q})]}),(0,a.jsx)("div",{className:"flex items-center justify-between mb-8",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-slate-900 mb-2",children:"My Quotes"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Review and accept quotes from medical professionals"})]})}),0===s.length?(0,a.jsx)(i.Zb,{children:(0,a.jsxs)(i.eW,{className:"text-center py-12",children:[(0,a.jsx)(u.Z,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),(0,a.jsx)("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"No Quotes Yet"}),(0,a.jsx)("p",{className:"text-gray-600 mb-6",children:"You haven't received any quotes yet. Create a case to get started."}),(0,a.jsx)(n.default,{href:"/treatments",children:(0,a.jsx)(c.Z,{size:"lg",children:"Browse Treatments"})})]})}):(0,a.jsx)("div",{className:"space-y-6",children:s.map(e=>{var t,s;return(0,a.jsx)(i.Zb,{className:"hover:shadow-lg transition-shadow",children:(0,a.jsx)(i.eW,{children:(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,a.jsxs)("h3",{className:"text-xl font-bold text-slate-900",children:["Quote #",e.id.slice(-8)]}),(0,a.jsxs)("span",{className:"inline-flex items-center gap-1 px-3 py-1 rounded-full text-sm font-medium ".concat(O(e.status)),children:[Q(e.status),e.status]})]}),e.case&&(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsxs)("h4",{className:"font-semibold text-slate-900 mb-1",children:["Case #",e.case.id.slice(-8)]}),e.case.treatment&&(0,a.jsx)("p",{className:"text-gray-600",children:e.case.treatment.name}),e.case.patient_notes&&(0,a.jsx)("p",{className:"text-gray-500 text-sm mt-1",children:e.case.patient_notes})]}),e.doctor&&(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsxs)("h4",{className:"font-semibold text-slate-900 mb-1 flex items-center gap-2",children:[(0,a.jsx)(h.Z,{className:"w-4 h-4"}),"Doctor"]}),(0,a.jsx)("p",{className:"text-gray-600",children:e.doctor.full_name||"Anonymous Doctor"}),(0,a.jsx)("p",{className:"text-gray-500 text-sm",children:e.doctor.email})]}),(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsxs)("h4",{className:"font-semibold text-slate-900 mb-1 flex items-center gap-2",children:[(0,a.jsx)(f.Z,{className:"w-4 h-4"}),"Quote Amount"]}),(0,a.jsxs)("div",{className:"text-2xl font-bold text-green-600",children:["₹",(null===(t=e.total)||void 0===t?void 0:t.toLocaleString())||"TBD"]})]}),(0,a.jsx)("div",{className:"flex items-center gap-4 text-sm text-gray-500",children:(0,a.jsxs)("span",{className:"flex items-center gap-1",children:[(0,a.jsx)(j.Z,{className:"w-4 h-4"}),"Received ",new Date(e.created_at).toLocaleDateString()]})})]}),(0,a.jsxs)("div",{className:"flex flex-col gap-2 ml-6",children:[(0,a.jsx)(n.default,{href:"/patient/case/".concat(null===(s=e.case)||void 0===s?void 0:s.id,"/uploads"),children:(0,a.jsx)(c.Z,{variant:"outline",size:"sm",icon:p.Z,children:"View Case"})}),"sent"===e.status&&(0,a.jsx)(c.Z,{onClick:()=>R(e.id,e.case_id),loading:Z===e.id,size:"sm",className:"bg-green-600 hover:bg-green-700",icon:o.Z,children:"Accept Quote"}),"accepted"===e.status&&(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"text-green-600 font-medium text-sm mb-1",children:"✓ Accepted"}),(0,a.jsx)("div",{className:"text-xs text-gray-500",children:new Date(e.updated_at).toLocaleDateString()})]})]})]})})},e.id)})}),s.length>0&&(0,a.jsxs)("div",{className:"mt-12 grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,a.jsx)(i.Zb,{children:(0,a.jsxs)(i.eW,{className:"text-center",children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-blue-600 mb-1",children:s.length}),(0,a.jsx)("div",{className:"text-sm text-gray-600",children:"Total Quotes"})]})}),(0,a.jsx)(i.Zb,{children:(0,a.jsxs)(i.eW,{className:"text-center",children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-yellow-600 mb-1",children:s.filter(e=>"sent"===e.status).length}),(0,a.jsx)("div",{className:"text-sm text-gray-600",children:"Pending Review"})]})}),(0,a.jsx)(i.Zb,{children:(0,a.jsxs)(i.eW,{className:"text-center",children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-green-600 mb-1",children:s.filter(e=>"accepted"===e.status).length}),(0,a.jsx)("div",{className:"text-sm text-gray-600",children:"Accepted"})]})})]})]})}),I&&D&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,a.jsx)("div",{className:"bg-white rounded-lg max-w-md w-full p-6",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,a.jsx)(o.Z,{className:"w-8 h-8 text-green-600"})}),(0,a.jsx)("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:"Quote Accepted!"}),(0,a.jsx)("p",{className:"text-gray-600 mb-6",children:"Your quote has been accepted. Payment link will be sent to your email shortly."}),(0,a.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4 mb-6 text-left",children:[(0,a.jsx)("h4",{className:"font-semibold text-gray-900 mb-3",children:"Payment Breakdown"}),(0,a.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{children:"Total Amount (X):"}),(0,a.jsxs)("span",{className:"font-medium",children:["₹",null===(e=D.total)||void 0===e?void 0:e.toLocaleString()]})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{children:"Platform Fee (A):"}),(0,a.jsxs)("span",{className:"font-medium",children:["₹",Math.round(.15*(D.total||0)).toLocaleString()]})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{children:"Doctor Transfer (Y):"}),(0,a.jsxs)("span",{className:"font-medium",children:["₹",Math.round(.85*(D.total||0)).toLocaleString()]})]}),(0,a.jsx)("hr",{className:"my-2"}),(0,a.jsxs)("div",{className:"flex justify-between font-semibold",children:[(0,a.jsx)("span",{children:"You Pay:"}),(0,a.jsxs)("span",{className:"text-green-600",children:["₹",null===(t=D.total)||void 0===t?void 0:t.toLocaleString()]})]})]})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)(c.Z,{onClick:()=>z(!1),className:"w-full bg-blue-600 hover:bg-blue-700",children:"Continue"}),(0,a.jsx)("p",{className:"text-xs text-gray-500",children:"A payment link will be sent to your registered email address within 24 hours."})]})]})})}),(0,a.jsx)(y.default,{})]})}},4226:function(e,t,s){"use strict";var a=s(7437),r=s(2265),n=s(4508);let l=r.forwardRef((e,t)=>{let{variant:s="primary",size:r="md",icon:l,iconPosition:i="left",loading:c=!1,className:d,children:o,disabled:x,...m}=e,u=(0,n.cn)("btn inline-flex items-center justify-center gap-2 font-medium transition-all duration-200 focus-visible:outline-2 focus-visible:outline-ring focus-visible:outline-offset-2 disabled:opacity-50 disabled:cursor-not-allowed",{primary:"btn-primary",secondary:"btn-secondary",ghost:"btn-ghost",outline:"btn-outline",link:"btn-link"}[s],{sm:"px-3 py-2 text-sm",md:"px-4 py-2.5 text-base",lg:"px-6 py-3 text-lg"}[r],d);return(0,a.jsxs)("button",{ref:t,className:u,disabled:x||c,...m,children:[c&&(0,a.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-current border-t-transparent"}),l&&"left"===i&&!c&&(0,a.jsx)(l,{className:"h-4 w-4"}),o,l&&"right"===i&&!c&&(0,a.jsx)(l,{className:"h-4 w-4"})]})});l.displayName="Button",t.Z=l},9178:function(e,t,s){"use strict";s.d(t,{Ol:function(){return i},Zb:function(){return l},eW:function(){return c}});var a=s(7437),r=s(2265),n=s(4508);let l=r.forwardRef((e,t)=>{let{variant:s="default",padding:r="md",className:l,children:i,...c}=e,d=(0,n.cn)("card",{default:"bg-surface border-border",elevated:"bg-surface border-transparent shadow-lg",outlined:"bg-transparent border-border"}[s],{none:"",sm:"p-4",md:"p-6",lg:"p-8"}[r],l);return(0,a.jsx)("div",{ref:t,className:d,...c,children:i})}),i=r.forwardRef((e,t)=>{let{className:s,children:r,...l}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("card-header",s),...l,children:r})}),c=r.forwardRef((e,t)=>{let{className:s,children:r,...l}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("card-body",s),...l,children:r})}),d=r.forwardRef((e,t)=>{let{className:s,children:r,...l}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("card-footer",s),...l,children:r})});l.displayName="Card",i.displayName="CardHeader",c.displayName="CardBody",d.displayName="CardFooter"},970:function(e,t,s){"use strict";s.d(t,{e:function(){return r}});var a=s(6188);let r=()=>(0,a.createBrowserClient)("https://eqjpdytmsohfpohecczz.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImVxanBkeXRtc29oZnBvaGVjY3p6Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTg4MzM1NzcsImV4cCI6MjA3NDQwOTU3N30.DDNR98O9E1rcWirNZPOuoSYjaUDSuReNcZQbZtxTjgQ")},4508:function(e,t,s){"use strict";s.d(t,{cn:function(){return n}});var a=s(1994),r=s(3335);function n(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,r.m6)((0,a.W)(t))}},2252:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(9763).Z)("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},2660:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(9763).Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},1047:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(9763).Z)("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]])},2208:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(9763).Z)("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},3417:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(9763).Z)("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]])},2369:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(9763).Z)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])}},function(e){e.O(0,[972,862,137,188,349,422,971,117,744],function(){return e(e.s=9463)}),_N_E=e.O()}]);