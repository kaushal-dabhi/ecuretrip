(()=>{var e={};e.id=869,e.ids=[869],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},2615:e=>{"use strict";e.exports=require("http")},5240:e=>{"use strict";e.exports=require("https")},8621:e=>{"use strict";e.exports=require("punycode")},6162:e=>{"use strict";e.exports=require("stream")},7360:e=>{"use strict";e.exports=require("url")},1568:e=>{"use strict";e.exports=require("zlib")},7754:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>l.Z,__next_app__:()=>x,originalPathname:()=>o,pages:()=>d,routeModule:()=>m,tree:()=>c}),s(2452),s(5940),s(6083),s(6560);var a=s(3191),r=s(8716),l=s(8001),i=s(5231),n={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(n[e]=()=>i[e]);s.d(t,n);let c=["",{children:["patient",{children:["quotes",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,2452)),"/Users/kaushaldabhi/new_website/app/patient/quotes/page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,5940)),"/Users/kaushaldabhi/new_website/app/layout.tsx"],error:[()=>Promise.resolve().then(s.bind(s,6083)),"/Users/kaushaldabhi/new_website/app/error.tsx"],"not-found":[()=>Promise.resolve().then(s.bind(s,6560)),"/Users/kaushaldabhi/new_website/app/not-found.tsx"]}],d=["/Users/kaushaldabhi/new_website/app/patient/quotes/page.tsx"],o="/patient/quotes/page",x={require:s,loadChunk:()=>Promise.resolve()},m=new a.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/patient/quotes/page",pathname:"/patient/quotes",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},5479:(e,t,s)=>{Promise.resolve().then(s.bind(s,6612))},6612:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>N});var a=s(326),r=s(7577),l=s(434),i=s(2945),n=s(1021),c=s(3679),d=s(8998),o=s(4659),x=s(7888),m=s(6333),u=s(617),h=s(9635),p=s(1821),f=s(7358),b=s(2714),g=s(2900),j=s(7553),y=s(725);function N(){let[e,t]=(0,r.useState)([]),[s,N]=(0,r.useState)(!0),[w,v]=(0,r.useState)(null),[Z,_]=(0,r.useState)(null),[k,q]=(0,r.useState)(null),[S,P]=(0,r.useState)(!1),[C,I]=(0,r.useState)(null);async function z(){try{let e=(0,i.e)(),{data:{user:s}}=await e.auth.getUser();if(!s){_("Please sign in to view quotes");return}let{data:a}=await e.from("patients").select("*").eq("profile_id",s.id).single();if(!a){_("Patient record not found");return}let{data:r,error:l}=await e.from("quotes").select(`
          *,
          case:cases(id, patient_id, treatment_id, status, patient_notes, treatment:treatments(id, name, description)),
          doctor:profiles(id, full_name, email)
        `).eq("case.patient_id",a.id).order("created_at",{ascending:!1});if(l)throw l;t(r||[])}catch(e){_("Failed to load quotes"),console.error("Error fetching quotes:",e)}finally{N(!1)}}async function A(e,t){v(e),_(null);try{let s=(0,i.e)(),{data:a}=await s.from("quotes").select("*").eq("id",e).single();if(!a)throw Error("Quote not found");let{error:r}=await s.from("quotes").update({status:"accepted",updated_at:new Date().toISOString()}).eq("id",e);if(r)throw r;let{error:l}=await s.from("cases").update({status:"accepted",updated_at:new Date().toISOString()}).eq("id",t);if(l)throw l;let n=a.total||0,c=Math.round(.15*n),d=n-c,{error:o}=await s.from("finance_notes").insert({case_id:t,quote_id:e,x_amount:n,a_fee:c,y_transfer:d,z_profit:c,currency:a.currency||"INR",status:"pending",payment_method:"payment_link_pending",created_at:new Date().toISOString()});if(o)throw o;I(a),P(!0),await z()}catch(e){_(e.message||"Failed to accept quote")}finally{v(null)}}let D=e=>{switch(e){case"draft":default:return"bg-gray-100 text-gray-800";case"sent":return"bg-blue-100 text-blue-800";case"accepted":return"bg-green-100 text-green-800"}},M=e=>{switch(e){case"sent":return a.jsx(d.Z,{className:"w-4 h-4"});case"accepted":return a.jsx(o.Z,{className:"w-4 h-4"});default:return a.jsx(x.Z,{className:"w-4 h-4"})}};return s?(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[a.jsx(g.Z,{}),a.jsx(j.Z,{}),a.jsx("div",{className:"pt-32 pb-16",children:a.jsx("div",{className:"max-w-4xl mx-auto px-6",children:(0,a.jsxs)("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),a.jsx("p",{className:"text-lg text-gray-600",children:"Loading quotes..."})]})})})]}):(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[a.jsx(g.Z,{}),a.jsx(j.Z,{}),a.jsx("div",{className:"pt-32 pb-16",children:(0,a.jsxs)("div",{className:"max-w-4xl mx-auto px-6",children:[a.jsx("div",{className:"mb-8",children:a.jsx(l.default,{href:"/patient/dashboard",children:a.jsx(c.Z,{variant:"ghost",icon:m.Z,children:"Back to Dashboard"})})}),Z&&(0,a.jsxs)("div",{className:"mb-6 p-4 bg-red-50 border border-red-200 rounded-lg flex items-center gap-3",children:[a.jsx(x.Z,{className:"w-5 h-5 text-red-600 flex-shrink-0"}),a.jsx("p",{className:"text-red-800 text-sm",children:Z})]}),k&&(0,a.jsxs)("div",{className:"mb-6 p-4 bg-green-50 border border-green-200 rounded-lg flex items-center gap-3",children:[a.jsx(o.Z,{className:"w-5 h-5 text-green-600 flex-shrink-0"}),a.jsx("p",{className:"text-green-800 text-sm",children:k})]}),a.jsx("div",{className:"flex items-center justify-between mb-8",children:(0,a.jsxs)("div",{children:[a.jsx("h1",{className:"text-3xl font-bold text-slate-900 mb-2",children:"My Quotes"}),a.jsx("p",{className:"text-gray-600",children:"Review and accept quotes from medical professionals"})]})}),0===e.length?a.jsx(n.Zb,{children:(0,a.jsxs)(n.eW,{className:"text-center py-12",children:[a.jsx(u.Z,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),a.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"No Quotes Yet"}),a.jsx("p",{className:"text-gray-600 mb-6",children:"You haven't received any quotes yet. Create a case to get started."}),a.jsx(l.default,{href:"/treatments",children:a.jsx(c.Z,{size:"lg",children:"Browse Treatments"})})]})}):a.jsx("div",{className:"space-y-6",children:e.map(e=>a.jsx(n.Zb,{className:"hover:shadow-lg transition-shadow",children:a.jsx(n.eW,{children:(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,a.jsxs)("h3",{className:"text-xl font-bold text-slate-900",children:["Quote #",e.id.slice(-8)]}),(0,a.jsxs)("span",{className:`inline-flex items-center gap-1 px-3 py-1 rounded-full text-sm font-medium ${D(e.status)}`,children:[M(e.status),e.status]})]}),e.case&&(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsxs)("h4",{className:"font-semibold text-slate-900 mb-1",children:["Case #",e.case.id.slice(-8)]}),e.case.treatment&&a.jsx("p",{className:"text-gray-600",children:e.case.treatment.name}),e.case.patient_notes&&a.jsx("p",{className:"text-gray-500 text-sm mt-1",children:e.case.patient_notes})]}),e.doctor&&(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsxs)("h4",{className:"font-semibold text-slate-900 mb-1 flex items-center gap-2",children:[a.jsx(h.Z,{className:"w-4 h-4"}),"Doctor"]}),a.jsx("p",{className:"text-gray-600",children:e.doctor.full_name||"Anonymous Doctor"}),a.jsx("p",{className:"text-gray-500 text-sm",children:e.doctor.email})]}),(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsxs)("h4",{className:"font-semibold text-slate-900 mb-1 flex items-center gap-2",children:[a.jsx(p.Z,{className:"w-4 h-4"}),"Quote Amount"]}),(0,a.jsxs)("div",{className:"text-2xl font-bold text-green-600",children:["₹",e.total?.toLocaleString()||"TBD"]})]}),a.jsx("div",{className:"flex items-center gap-4 text-sm text-gray-500",children:(0,a.jsxs)("span",{className:"flex items-center gap-1",children:[a.jsx(f.Z,{className:"w-4 h-4"}),"Received ",new Date(e.created_at).toLocaleDateString()]})})]}),(0,a.jsxs)("div",{className:"flex flex-col gap-2 ml-6",children:[a.jsx(l.default,{href:`/patient/case/${e.case?.id}/uploads`,children:a.jsx(c.Z,{variant:"outline",size:"sm",icon:b.Z,children:"View Case"})}),"sent"===e.status&&a.jsx(c.Z,{onClick:()=>A(e.id,e.case_id),loading:w===e.id,size:"sm",className:"bg-green-600 hover:bg-green-700",icon:o.Z,children:"Accept Quote"}),"accepted"===e.status&&(0,a.jsxs)("div",{className:"text-center",children:[a.jsx("div",{className:"text-green-600 font-medium text-sm mb-1",children:"✓ Accepted"}),a.jsx("div",{className:"text-xs text-gray-500",children:new Date(e.updated_at).toLocaleDateString()})]})]})]})})},e.id))}),e.length>0&&(0,a.jsxs)("div",{className:"mt-12 grid grid-cols-1 md:grid-cols-3 gap-6",children:[a.jsx(n.Zb,{children:(0,a.jsxs)(n.eW,{className:"text-center",children:[a.jsx("div",{className:"text-2xl font-bold text-blue-600 mb-1",children:e.length}),a.jsx("div",{className:"text-sm text-gray-600",children:"Total Quotes"})]})}),a.jsx(n.Zb,{children:(0,a.jsxs)(n.eW,{className:"text-center",children:[a.jsx("div",{className:"text-2xl font-bold text-yellow-600 mb-1",children:e.filter(e=>"sent"===e.status).length}),a.jsx("div",{className:"text-sm text-gray-600",children:"Pending Review"})]})}),a.jsx(n.Zb,{children:(0,a.jsxs)(n.eW,{className:"text-center",children:[a.jsx("div",{className:"text-2xl font-bold text-green-600 mb-1",children:e.filter(e=>"accepted"===e.status).length}),a.jsx("div",{className:"text-sm text-gray-600",children:"Accepted"})]})})]})]})}),S&&C&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:a.jsx("div",{className:"bg-white rounded-lg max-w-md w-full p-6",children:(0,a.jsxs)("div",{className:"text-center",children:[a.jsx("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4",children:a.jsx(o.Z,{className:"w-8 h-8 text-green-600"})}),a.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:"Quote Accepted!"}),a.jsx("p",{className:"text-gray-600 mb-6",children:"Your quote has been accepted. Payment link will be sent to your email shortly."}),(0,a.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4 mb-6 text-left",children:[a.jsx("h4",{className:"font-semibold text-gray-900 mb-3",children:"Payment Breakdown"}),(0,a.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[a.jsx("span",{children:"Total Amount (X):"}),(0,a.jsxs)("span",{className:"font-medium",children:["₹",C.total?.toLocaleString()]})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[a.jsx("span",{children:"Platform Fee (A):"}),(0,a.jsxs)("span",{className:"font-medium",children:["₹",Math.round(.15*(C.total||0)).toLocaleString()]})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[a.jsx("span",{children:"Doctor Transfer (Y):"}),(0,a.jsxs)("span",{className:"font-medium",children:["₹",Math.round(.85*(C.total||0)).toLocaleString()]})]}),a.jsx("hr",{className:"my-2"}),(0,a.jsxs)("div",{className:"flex justify-between font-semibold",children:[a.jsx("span",{children:"You Pay:"}),(0,a.jsxs)("span",{className:"text-green-600",children:["₹",C.total?.toLocaleString()]})]})]})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[a.jsx(c.Z,{onClick:()=>P(!1),className:"w-full bg-blue-600 hover:bg-blue-700",children:"Continue"}),a.jsx("p",{className:"text-xs text-gray-500",children:"A payment link will be sent to your registered email address within 24 hours."})]})]})})}),a.jsx(y.default,{})]})}},3679:(e,t,s)=>{"use strict";s.d(t,{Z:()=>c});var a=s(326),r=s(7577),l=s.n(r),i=s(7863);let n=l().forwardRef(({variant:e="primary",size:t="md",icon:s,iconPosition:r="left",loading:l=!1,className:n,children:c,disabled:d,...o},x)=>{let m=(0,i.cn)("btn inline-flex items-center justify-center gap-2 font-medium transition-all duration-200 focus-visible:outline-2 focus-visible:outline-ring focus-visible:outline-offset-2 disabled:opacity-50 disabled:cursor-not-allowed",{primary:"btn-primary",secondary:"btn-secondary",ghost:"btn-ghost",outline:"btn-outline",link:"btn-link"}[e],{sm:"px-3 py-2 text-sm",md:"px-4 py-2.5 text-base",lg:"px-6 py-3 text-lg"}[t],n);return(0,a.jsxs)("button",{ref:x,className:m,disabled:d||l,...o,children:[l&&a.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-current border-t-transparent"}),s&&"left"===r&&!l&&a.jsx(s,{className:"h-4 w-4"}),c,s&&"right"===r&&!l&&a.jsx(s,{className:"h-4 w-4"})]})});n.displayName="Button";let c=n},1021:(e,t,s)=>{"use strict";s.d(t,{Ol:()=>c,Zb:()=>n,eW:()=>d});var a=s(326),r=s(7577),l=s.n(r),i=s(7863);let n=l().forwardRef(({variant:e="default",padding:t="md",className:s,children:r,...l},n)=>{let c=(0,i.cn)("card",{default:"bg-surface border-border",elevated:"bg-surface border-transparent shadow-lg",outlined:"bg-transparent border-border"}[e],{none:"",sm:"p-4",md:"p-6",lg:"p-8"}[t],s);return a.jsx("div",{ref:n,className:c,...l,children:r})}),c=l().forwardRef(({className:e,children:t,...s},r)=>a.jsx("div",{ref:r,className:(0,i.cn)("card-header",e),...s,children:t})),d=l().forwardRef(({className:e,children:t,...s},r)=>a.jsx("div",{ref:r,className:(0,i.cn)("card-body",e),...s,children:t})),o=l().forwardRef(({className:e,children:t,...s},r)=>a.jsx("div",{ref:r,className:(0,i.cn)("card-footer",e),...s,children:t}));n.displayName="Card",c.displayName="CardHeader",d.displayName="CardBody",o.displayName="CardFooter"},2945:(e,t,s)=>{"use strict";s.d(t,{e:()=>r});var a=s(9557);let r=()=>(0,a.createBrowserClient)("https://eqjpdytmsohfpohecczz.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImVxanBkeXRtc29oZnBvaGVjY3p6Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTg4MzM1NzcsImV4cCI6MjA3NDQwOTU3N30.DDNR98O9E1rcWirNZPOuoSYjaUDSuReNcZQbZtxTjgQ")},7863:(e,t,s)=>{"use strict";s.d(t,{cn:()=>l});var a=s(1135),r=s(1009);function l(...e){return(0,r.m6)((0,a.W)(e))}},7888:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});let a=(0,s(6557).Z)("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},6333:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});let a=(0,s(6557).Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},7358:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});let a=(0,s(6557).Z)("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]])},2714:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});let a=(0,s(6557).Z)("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},617:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});let a=(0,s(6557).Z)("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]])},9635:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});let a=(0,s(6557).Z)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])},2452:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});let a=(0,s(8570).createProxy)(String.raw`/Users/kaushaldabhi/new_website/app/patient/quotes/page.tsx#default`)}};var t=require("../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),a=t.X(0,[276,672,25,325,557,749,725,920],()=>s(7754));module.exports=a})();